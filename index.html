<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Super Mangonio Bros</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: black;
      color: white;
      font-family: 'Courier New', monospace;
      overflow: hidden;
    }

    canvas {
      display: block;
      margin: auto;
      background-color: #5c94fc;
      border: 4px solid #222;
    }

    #startScreen, #pauseScreen, #loadingScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.85);
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 18px;
      text-align: center;
      z-index: 10;
    }

    #pauseScreen { display: none; }
    #startScreen h1 {
      font-size: 32px;
      margin-bottom: 10px;
    }

    #startScreen ul {
      text-align: left;
    }
  </style>
</head>
<body>

<div id="loadingScreen">Cargando juego...</div>
<div id="startScreen">
  <div>
    <h1>Super Mangonio Bros</h1>
    <p>Presiona <strong>Q</strong> para comenzar</p>
    <h2>Controles:</h2>
    <ul>
      <li><strong>A</strong>: Mover a la izquierda</li>
      <li><strong>D</strong>: Mover a la derecha</li>
      <li><strong>ESPACIO</strong>: Saltar</li>
      <li><strong>Q</strong>: Iniciar juego</li>
      <li><strong>P</strong>: Pausar</li>
    </ul>
  </div>
</div>

<div id="pauseScreen"><h2>Juego en pausa. Presiona P para continuar</h2></div>

<canvas id="game" width="512" height="256"></canvas>
<audio id="bgm" src="music.mp3" loop></audio>

<script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  const playerImg = new Image();
  playerImg.src = 'mango8bit.png';

  const mushroomImg = new Image();
  mushroomImg.src = 'mushroom.png';

  const fireflowerImg = new Image();
  fireflowerImg.src = 'fireflower.png';

  let keys = {};
  let gameStarted = false;
  let paused = false;

  const bgm = document.getElementById('bgm');

  const player = {
    x: 50,
    y: 200,
    w: 16,
    h: 16,
    vy: 0,
    grounded: false,
    big: false,
    fire: false
  };

  const gravity = 0.8;
  const jumpPower = -10;
  const speed = 2;

  const mushrooms = [{ x: 200, y: 200, w: 16, h: 16 }];
  const fireflowers = [{ x: 300, y: 200, w: 16, h: 16 }];

  function drawPlayer() {
    ctx.drawImage(playerImg, player.x, player.y, player.w, player.h);
  }

  function drawPowerups() {
    mushrooms.forEach(m => ctx.drawImage(mushroomImg, m.x, m.y, m.w, m.h));
    fireflowers.forEach(f => ctx.drawImage(fireflowerImg, f.x, f.y, f.w, f.h));
  }

  function update() {
    if (!paused && gameStarted) {
      // Movimiento horizontal
      if (keys['a']) player.x -= speed;
      if (keys['d']) player.x += speed;

      // Saltar
      if (keys[' '] && player.grounded) {
        player.vy = jumpPower;
        player.grounded = false;
      }

      // Gravedad
      player.vy += gravity;
      player.y += player.vy;

      if (player.y + player.h >= canvas.height) {
        player.y = canvas.height - player.h;
        player.vy = 0;
        player.grounded = true;
      }

      // Colisiones con power-ups
      mushrooms.forEach((m, i) => {
        if (collides(player, m)) {
          player.big = true;
          player.h = 32;
          mushrooms.splice(i, 1);
        }
      });

      fireflowers.forEach((f, i) => {
        if (collides(player, f)) {
          player.fire = true;
          fireflowers.splice(i, 1);
        }
      });
    }
  }

  function collides(a, b) {
    return a.x < b.x + b.w &&
           a.x + a.w > b.x &&
           a.y < b.y + b.h &&
           a.y + a.h > b.y;
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawPlayer();
    drawPowerups();
  }

  function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
  }

  window.addEventListener('keydown', e => {
    keys[e.key.toLowerCase()] = true;

    if (e.key.toLowerCase() === 'q' && !gameStarted) {
      document.getElementById('startScreen').style.display = 'none';
      document.getElementById('loadingScreen').style.display = 'none';
      bgm.play();
      gameStarted = true;
    }

    if (e.key.toLowerCase() === 'p') {
      paused = !paused;
      document.getElementById('pauseScreen').style.display = paused ? 'flex' : 'none';
    }
  });

  window.addEventListener('keyup', e => {
    keys[e.key.toLowerCase()] = false;
  });

  window.onload = () => {
    // Ocultar loading despu√©s de cargar
    document.getElementById('loadingScreen').style.display = 'none';
    gameLoop();
  };
</script>

</body>
</html>
